This is the go version of detector.